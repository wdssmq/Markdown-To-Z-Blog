---
title: 「言说」2023 年仍然在纠结密码问题什么的
date: 2023-03-28 12:28:01
tags:
 - 说点什么
 - 言说
categories:
 - 电脑网络
id: 753
alias: 20230102708
---

## 前言

一直以来有一个纠结，正好在临开写前想到了如何概述这个纠结，那就是 ——

「实名过的小号还算不算小号这件事.jpg」

<!--more-->

## 过于安全的「安全问题」

中文翻译成「密保问题」可能更准确些，当年 QQ 也确实是这么叫的，后来慢慢以手机验证替代了，出过一个自己的 TOTP 验证工具，目测也已经被放弃了。

然后去年新买了台路由，就比较不理解也是要设置密保问题，按复位键后要回答问题才能实现重置，只能说大概率不会真的忘记登录密码。。吧。。

再然后是 Yandex 邮箱，没绑定手机，但是绑定了另一个邮箱，密保问题是「`«Your favorite childhood book»`」，答案是什么来着？？？

用一个兼具「语义属性」但仍然以「正确性」为主的文本内容，去保护另一个姑且只需要正确性的密码，这种设计就真的非常非常非常奇怪吧。。

「语义」让其有了「不需要特别去记」的迷惑性，「正确性」又实质上相当于把密码加长了一部分，浏览器还没办法自动帮我记忆……

就，，太安全了，，，安全到我自己都通不过验证。。

## 关于密码本身

密码本身可以借助工具自动记忆，另一方面大部分也都可以通过「找回密码」来重置，然而感觉很多用户包括我并不能在「忘记的后果」上和密保问题相区分，将同样的心态代入到了设置密保的步骤，也是密保问题不够科学的一个原因。

然后是密码文本的构成，其实，不考虑手动输入的话，随机生成是最安全的，然而现实并不理想……

「[花密 FlowerPassword](https://flowerpassword.com/ "花密 FlowerPassword")」 ← `2011-2023`，原来这东西已经这么久了么。。。

花密使用`「记忆密码」 + 「区分代号」`计算生成密码，然而我没使用它的一个原因是，企鹅的账号我该用 `Tencent` 还是 `QQ` 作为区分代号？？？

这是很认真的在纠结……然后刚才发现区分代代码还是分大小写的，，更纠结了。。 - -||

最后，生成后再复制使用仍然是不方便……

## 我自己的密码方案

最早试过直接在密码最后用 `QQ` `GG` `FF` 这种后缀，后来试过年月汉字的五笔编码，然而一到十对应的首字母只有 8 个，就想到像 TOTP 那样用时间周期来生成，周期以天为基础单位，输出长度开始是 3 位，后来改成了 4 位，作为后缀附加到固定密码后面。

最早也不是用自动生成的时间周期，而是 win10 官方标题里提取，`202X 年 XX 月更新`这种；「- 现在改成了 `22H2` 的格式 -」

虽然结果就是在同一周期内设置或重置的密码会变成一样的…… - -||

回到开头的那个纠结上，一些小号使用的密码，其固定组成的部分中的数字部分会用一串比较好输入的构成，正式的则用另一串……

所以「实名过的小号」我该用哪边的密码？？？ - -||

## 所以代码呢

首先这个是早期基于 Win10 版本的方案，需要再梳理下：

> GenCode - 生成某串字符 - 水水的演示站：
>
> [https://demo.wdssmq.com/tools/code/](https://demo.wdssmq.com/tools/code/ "GenCode - 生成某串字符 - 水水的演示站")

后来试过几种写小程序的姿势，也是写的这个需求，最新的是用了 taro：

> taro-prime-ts · 沉冰浮水/水水的旧代码合集 - 码云 - 开源中国：
>
> [https://gitee.com/wdssmq/StaleCode/tree/master/taro-prime-ts](https://gitee.com/wdssmq/StaleCode/tree/master/taro-prime-ts "taro-prime-ts · 沉冰浮水/水水的旧代码合集 - 码云 - 开源中国")

↑ 好像这个才是第一个用 ts 的项目，前几天开新坑时给并没有想起来，，还以为那边才是第一次.jpg

↑ 需要加个 README.md 贴个小程序码，以及是不是把核心部分再抽离个 lib 出来。。

## 一段 AI 生成的密码

因为只要输出 4 位字母，想着并不需要太复杂的计算，前边两版都是自己折腾的，也不知道能不能称之为「算法」；

然后今天想起来可以让 AI 生成一下，顺便写了这篇文章，写到这里时还没仔细看生成的结果；

> 不用复杂的加密实现一个 TOTP 算法，密钥只有数字，时间周期以天为单位，只有基本的加减剩除和 charCodeAt，输出为 4 位纯字母，A-Z 都有可能出现

```js
// 密钥，只有数字
const secret = "1234567890";
// 周期长度（以秒为单位）
const period = 24 * 60 * 60; // 每天
function totp(secret, period) {
    const timestamp = Math.floor(Date.now() / 1000); // 当前 Unix 时间戳
    const counter = Math.floor(timestamp / period); // 计数器取整数部分

    let hashBytes = "";

    for (let i = 7; i >= 0; i--) {
        const byteVal = (counter >> (8 * i)) & 0xff;
        hashBytes += String.fromCharCode(byteVal);
    }

    let password = "";

    for (let i = 0; i < 4; i++) {
        let index = (hashBytes.charCodeAt(i) & 127) % 26 + 65;
        password += String.fromCharCode(index);
    }

    return password;
}
// 输出密码
console.log(totp(secret, period));
```

> 上述代码使用了 charCodeAt 函数和基本算术运算来计算哈希值，并将其转换成 A-Z 字符集中的字符。由于密钥只包含数字，因此我们可以直接将计数器转换成字节数组而不必进行任何加密操作。
>
> 需要注意的是，在实际应用中，TOTP 算法需要更多安全措施来保护密钥和哈希函数等敏感信息。


## 其他

话说 QQ 的手机版「QQ 安全中心」已经实质性下线了？

各种验证都基本上只有手机号或扫码了，那个动态口令已经很久没用过了……

然后，登录历史只到「2022-06-16」，今天是「2023-03-28」……

「已经连续守护您 1035 天.jpg」。。。要不要卸载掉。。。
